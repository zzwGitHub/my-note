# 第四章

## 4.1 概述

- 设计类时，可以，找出问题中的名词定义为类，找出动词，定义为方法
- 类之间常见关系
  + 依赖  uses-a
  + 聚合  has-a
  + 继承  is-a

## 4.2 预定义类

- 更改器方法与访问器方法

## 4.3 用户自定义类

- 强调：属性就是要private ，然后提供 set get 方法，这样 **封装** 是提倡的。
- 一个java文件只能有一public类，而且这个类名必须和文件名一样
- 可以有任意个非共有类（要关注这些类是否为共有类的内部类），名字也没有限制
- javac时，有几个 class，就会生成几个 `.class` 文件
- 多文件编译时，如果被编译的主文件使用了其他 java 文件，那么自然也是会将其隐式编译的
- 隐式参数 与 显式参数。
  - 每一个方法中，关键字 this 表示隐式参数 
- 其实我一直都没有发现，get方法拿到的那个值，如果是可变对象，我就能直接给改了。
  - 所以书里推荐：get 方法使用`.clone()` 方法
- 基于类的访问权限
  - 方法不仅可以访问所调用对象的私有数据；同时，他也可以访问 **所属类的所有对象** 的私有数据！
  - 比如典型的 `equals()` 方法
- 方法也可以考虑定义为 `private` ，（假如确实是那种只属于自己的方法）这样的好处是，删除时可以毫不留情，因为：我确信别的地方一定不会用到。
- `final` 关键字修饰的属性：只是保证，对象引用不可变， **但是指向的那个对象可以变啊** 
  - 例如，`final Book b = new Book()` 只是保证 b 不能再指向其他的 Book 了

## 4.4 静态域 与 静态方法

- static 这个词只是从 C 上的沿用。java中的含义已经和“静态”没有什么关系了
- static 的意思是：**属于类，但是不属于类对象的变量和函数**
- 两种情况下使用静态方法
  - 一个方法不需要访问对象状态，其所需参数都是显式参数
  - 一个方法只需要访问类的静态域

## 4.5 方法参数

- call by value（按值调用） 与 call bu reference（按引用调用）
- java 总是 **按值调用**
- 当入参是基本数据类型时：
    + 方法得到的实际上是，调用传入值的一个拷贝
- 当入参是对象引用时：
    + 方法得到的实际上是，调用传入值的对象引用的一个拷贝
- 所以：
    - 一个方法不能修改一个基本数据类型的参数
    - 一个方法可以改变一个对象参数的状态
    - 一个方法不能让对象参数引用一个新的对象

## 4.6 对象构造

- 重载 的英文 overloading

- 我们清楚~必须为局部变量初始化；而域如果没有被初始化，它将会被自动初始化为默认值（0、 false、 null）
  
  - 意思就是，构造函数中如果没有为某field赋值，那么这个field就会被赋予默认值
  
- 使用 **显式域初始化** 的方式，确保每个 field 都能被初始化，这是很优秀的做法
  
  - 就是在声明 field 的时候，直接赋值
  
- 构造函数可以重载的，知道吧……
  
  - 在构造函数的第一行，可以使用 `this()` 去调用其他的构造函数，但是这种用法必须用在 **第一行**
  
- 初始化块

  - 这是为 field 初始化的第三种方式（另外两种是 构造器 与 声明时赋值）
  - 如果是对于非 static 的 field ，那么对它的赋值流程是
      1. 所有数据被初始化为默认值
      2. 依照在类中出现的顺序，依次执行所有 **field初始化语句** 和 **初始化块** 
      3. 执行构造器（有 this 必然先执行this）
  - 发现 **静态初始化块** 和 **静态域的赋值语句** 都是先于上述那些东西执行的
      - 当然他们两个也是遵循在类中的出现顺序来执行的

> 说了这么多，还是不推荐使用这么乱的初始化方式。最好别用代码块，写的代码易于让别人（自己）看出来field怎么被初始化的才是最重要的！

- finalize 方法，在垃圾回收器清除对象之前调用。

## 4.7  包

- 使用域名倒序，比如我的域名是 ziw.top 那么包名首先就是 top→ziw，后面再接项目（工程）名

- import 可以定位到 静态域 和 静态方法

- 应该“将每个类都放入包中”，意思就是，每个java文件开头是这样

  ```java
  package top.ziw.corejava
  ```

  - 如果开头没有package ，那么将会被放在 默认包（default package） 里

- 务必要将类文件按照包名来放置，否则即便编译OK，也无法运行

- java 和 javac 对于名称的区别

  ```shell
  javac top/ziw/corejava/Payrol1App.java
  java top.ziw.corejava.PayrollApp
  ```

- 包作用域，也就是不加 public 或者是private：这样的部分（类，域，方法）可以被同包内的其他类访问到。

## 4.8 类路径（有关手动打包）

- 编译java文件或者运行时，需要关注 classpath ，这一点在类文件不是单个的时候，至关重要。

- 关于环境变量（这里只针对Windows）
  
  - path 和 classpath 都是
  
  - 如果某EXE文件(比如QQ.exe) 在path里，那么cmd中qq回车，就可以启动qq，bat文件也行。
  
  - 环境变量分为 **用户变量** 和 **系统变量** ，他们显示在【系统属性】中
  
  - 两种管理手段
    1. 永久：在【系统属性】，可视化的鼓捣。
  
    2. 临时：在命令行中(只对当前窗口有效)
    ```shell
    1.查看所有：set
    2.查看某个环境变量：set 变量名    （echo也行，但是变量名需要%%包裹起来）
    3.修改环境变量 ：set 变量名=变量内容
    4.给变量追加内容(不同于上,那个是覆盖)：set 变量名=%变量名%;变量内容
    ```

- 在环境变量中，符号 `.` 表示当前目录

- java.lang 总是被自动导入

- classpath默认包含 `.`，所以设置classpath时，不能忘记点！！！

- jar 文件也能配置进入classpath中，（这似乎就需要定位到具体文件了）

- 想要手动运行 java 程序，配置 环境变量 classpath 是很重要的， 我们可以使用上面讲的两种方法，也可以使用第三种方式：  
    也就是在使用 java 或者 javac 命令时指定 `-classpath` 或 者 `-cp` 参数
    ```shell
    javac -classpath C:/balabal/xxx Demo.java
    java -classpath C:/balabal/xxx Demo
    ```

- 运行时 对于 classpath  的使用

  - 在任何目录下 使用 java 命令可以运行编译好的类。后面跟的类名，一定是 **类的全名称**，也就是带着包名的类，比如： com.ziw.Demo 。
    
  + 如果写成了 java javafile/Demo    就是等于执行  javafile.Demo 类（不要这样做啊~好乱）
    
  - java 命令执行时，会在 【一个路径范围】 中寻找类，这个范围是：

    1. 用**每个classpath地址** 去拼接 类的package，形成的路径
    
       比如像 top.ziw.Piano 类，拼接后的就是 classpath地址/top/ziw
    
    2. rt.jar     jre/lib     jre/lib/ext

- 编译时 对于 classpath 的使用

  - 和【运行时 对于 classpath  的使用】多少有些出入，大体一致

- 这个确实比想象中费劲，用到的时候，再来查阅吧......

- **用的时候，只要确保 classpath 配置好，然后每个类的package都写好，也都放在对的文件夹下，最后在正确的目录执行 javac java ，就可以保证万无一失！！！乱主要是因为，我想折腾他们..........**

## 4.9 文档注释

- javadoc 从下面几个特性中抽取信息
  - 包
  - 公有类和接口
  - 公有的和受保护的构造器及方法
  - 公有的和受保护的域
- 只需要对公有域编写文档
- 使用如下命令即可，注意应当指定`-d`文档生成路径，因为会生成一堆文件

```java
javadoc -d ./doc  RootDemo.java
```

- 具体的编码啊，什么的，用到时再说吧

## 4.10 总结（类设计技巧）

1. 一定要保证数据私有
   - 如此的好处是：即便数据表现形式更改，也不会对使用者产生影响
2. 一定要对数据初始化（不要依赖于默认的方式）
3. 不要在类中使用过多的基本类型
   - 尽量将一个类拆成多个
4. get 和 set 方法不是必须的
5. 职责过多的类也应当分解（与第3点一起结合考虑）
6. 类名和方法名要能体现他们的职责
   - 类名一般的命名方式：名词、前面有形容词修饰的名词、前面有动名词(ing后缀)修饰的名词
   - 方法名：如 get set
7. 优先使用不可变的类
   - 因为这样更安全（在并发的时候）